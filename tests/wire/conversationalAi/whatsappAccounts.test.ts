// This file was auto-generated by Fern from our API Definition.

import { ElevenLabsClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";

describe("WhatsappAccountsClient", () => {
    test("list", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            items: [
                {
                    business_account_id: "business_account_id",
                    phone_number_id: "phone_number_id",
                    business_account_name: "business_account_name",
                    phone_number_name: "phone_number_name",
                    phone_number: "phone_number",
                    assigned_agent_id: "assigned_agent_id",
                    assigned_agent_name: "assigned_agent_name",
                },
            ],
        };
        server
            .mockEndpoint()
            .get("/v1/convai/whatsapp-accounts")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.conversationalAi.whatsappAccounts.list();
        expect(response).toEqual({
            items: [
                {
                    businessAccountId: "business_account_id",
                    phoneNumberId: "phone_number_id",
                    businessAccountName: "business_account_name",
                    phoneNumberName: "phone_number_name",
                    phoneNumber: "phone_number",
                    assignedAgentId: "assigned_agent_id",
                    assignedAgentName: "assigned_agent_name",
                },
            ],
        });
    });

    test("import", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            business_account_id: "business_account_id",
            phone_number_id: "phone_number_id",
            token_code: "token_code",
        };
        const rawResponseBody = { phone_number_id: "phone_number_id" };
        server
            .mockEndpoint()
            .post("/v1/convai/whatsapp-accounts")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.conversationalAi.whatsappAccounts.import({
            businessAccountId: "business_account_id",
            phoneNumberId: "phone_number_id",
            tokenCode: "token_code",
        });
        expect(response).toEqual({
            phoneNumberId: "phone_number_id",
        });
    });

    test("get", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            business_account_id: "business_account_id",
            phone_number_id: "phone_number_id",
            business_account_name: "business_account_name",
            phone_number_name: "phone_number_name",
            phone_number: "phone_number",
            assigned_agent_id: "assigned_agent_id",
            assigned_agent_name: "assigned_agent_name",
        };
        server
            .mockEndpoint()
            .get("/v1/convai/whatsapp-accounts/phone_number_id")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.conversationalAi.whatsappAccounts.get("phone_number_id");
        expect(response).toEqual({
            businessAccountId: "business_account_id",
            phoneNumberId: "phone_number_id",
            businessAccountName: "business_account_name",
            phoneNumberName: "phone_number_name",
            phoneNumber: "phone_number",
            assignedAgentId: "assigned_agent_id",
            assignedAgentName: "assigned_agent_name",
        });
    });

    test("delete", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/v1/convai/whatsapp-accounts/phone_number_id")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.conversationalAi.whatsappAccounts.delete("phone_number_id");
        expect(response).toEqual({
            key: "value",
        });
    });

    test("update", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .patch("/v1/convai/whatsapp-accounts/phone_number_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.conversationalAi.whatsappAccounts.update("phone_number_id");
        expect(response).toEqual({
            key: "value",
        });
    });
});
