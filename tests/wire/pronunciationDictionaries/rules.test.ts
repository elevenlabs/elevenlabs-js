/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../../mock-server/MockServerPool.js";
import { ElevenLabsClient } from "../../../src/Client";

describe("Rules", () => {
    test("add", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({
            apiKey: "test",
            environment: { base: server.baseUrl, wss: server.baseUrl },
        });
        const rawRequestBody = { rules: [{ string_to_replace: "Thailand", alias: "tie-land", type: "alias" }] };
        const rawResponseBody = {
            id: "5xM3yVvZQKV0EfqQpLrJ",
            version_id: "5xM3yVvZQKV0EfqQpLr2",
            version_rules_num: 5,
        };
        server
            .mockEndpoint()
            .post("/v1/pronunciation-dictionaries/21m00Tcm4TlvDq8ikWAM/add-rules")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.rules.add("21m00Tcm4TlvDq8ikWAM", {
            rules: [
                {
                    type: "alias",
                    stringToReplace: "Thailand",
                    alias: "tie-land",
                },
            ],
        });
        expect(response).toEqual({
            id: "5xM3yVvZQKV0EfqQpLrJ",
            versionId: "5xM3yVvZQKV0EfqQpLr2",
            versionRulesNum: 5,
        });
    });

    test("remove", async () => {
        const server = mockServerPool.createServer();
        const client = new ElevenLabsClient({
            apiKey: "test",
            environment: { base: server.baseUrl, wss: server.baseUrl },
        });
        const rawRequestBody = { rule_strings: ["rule_strings"] };
        const rawResponseBody = {
            id: "5xM3yVvZQKV0EfqQpLrJ",
            version_id: "5xM3yVvZQKV0EfqQpLr2",
            version_rules_num: 5,
        };
        server
            .mockEndpoint()
            .post("/v1/pronunciation-dictionaries/21m00Tcm4TlvDq8ikWAM/remove-rules")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pronunciationDictionaries.rules.remove("21m00Tcm4TlvDq8ikWAM", {
            ruleStrings: ["rule_strings"],
        });
        expect(response).toEqual({
            id: "5xM3yVvZQKV0EfqQpLrJ",
            versionId: "5xM3yVvZQKV0EfqQpLr2",
            versionRulesNum: 5,
        });
    });
});
